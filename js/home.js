const getKst=()=>{let e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),o=new Date(t+324e5);return o},getDistanceFromLatLng=(e,t,o,n)=>{var a,i,l;let r=e=>Math.pow(e,2),s=6371;e*=Math.PI/180;let c=(o*=Math.PI/180)-e,d=(n-t)*(Math.PI/180);return 2*s*Math.asin(Math.sqrt(r(Math.sin(c/2))+Math.cos(e)*Math.cos(o)*r(Math.sin(d/2))))},copytoclipboard=e=>{var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)},inappbrowserout=()=>{copytoclipboard(window.location.href),alert('URL주소가 복사되었습니다.\n\nSafari가 열리면 주소창을 길게 터치한 뒤, "붙여놓기 및 이동"를 누르면 정상적으로 이용하실 수 있습니다.')},onclickInapp=()=>{navigator.userAgent.match(/iPhone|iPad/i)?(inappbrowserout(),location.href="x-web-search://?"):location.href="intent://"+location.href.replace(/https?:\/\//i,"")+"#Intent;scheme=http;package=com.android.chrome;end"},callAjax=(e,t)=>{var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&200==o.status&&t(JSON.parse(o.responseText))},o.open("GET",e,!0),o.send()},isInApp=()=>navigator.userAgent.match(/inapp|NAVER|KAKAOTALK|Snapchat|Line|WirtschaftsWoche|Thunderbird|Instagram|everytimeApp|WhatsApp|Electron|wadiz|AliApp|zumapp|iPhone(.*)Whale|Android(.*)Whale|kakaostory|band|twitter|DaumApps|DaumDevice\/mobile|FB_IAB|FB4A|FBAN|FBIOS|FBSS|SamsungBrowser\/[^1]/i),geolocationFunc=e=>{try{navigator&&"geolocation"in navigator&&navigator?.geolocation?.getCurrentPosition?isInApp()?e(void 0,void 0):navigator?.geolocation?.getCurrentPosition(t=>{e(t?.coords?.latitude,t?.coords?.longitude)}):e(void 0,void 0)}catch(t){e(void 0,void 0)}},numberCompare=(e,t)=>{let o=0;return e===t?o=0:e>t?o=1:e<t&&(o=-1),o},detail=e=>location.href=e,keyExists=(e,t)=>void 0!==e[t],checkAvailableWorkingTime=(e,t)=>{if(!t)return!1;let o=getKst(),n=e?7:o.getDay(),a=t[n];if(!a||"-"===a)return!1;let i=o.getHours(),l=o.getMinutes(),r=a.split("~");1==(""+i).length&&(i="0"+i),1==(""+l).length&&(l="0"+l);let s=new Date("2020-01-01 "+r[0]),c=new Date("2020-01-01 "+r[1]),d=new Date("2020-01-01 "+i+":"+l);return!!(s.getTime()<d.getTime()&&c.getTime()>=d.getTime())},init=(e,t)=>{let o="";callAjax(`${o}/json/all.json`,e=>{let t=[`<option value="">선택하세요</option>`];for(let o of e)t.push(`<option value="${o}">${o}</option>`);$("#addr1").html(t.join(""))}),$(e).on("change","#addr1",()=>{let e=$("#addr1").val();callAjax(`${o}/json/${encodeURI(e)}.json`,e=>{let t=[`<option value="">선택하세요</option>`];for(let o of e)t.push(`<option value="${o}">${o}</option>`);$("#addr2").html(t.join(""))})}),$(e).on("change","#addr2",()=>{let t=$("#addr1").val()+"-"+$("#addr2").val();callAjax(`${o}/json/${encodeURI(t)}.json`,t=>{let o=[`<option value="">선택하세요</option>`];for(let n of t)o.push(`<option value="${n}">${n}</option>`);$("#addr3").html(o.join(""));var a=e.getElementById("courseTooltip");if(a){var i=new bootstrap.Tooltip(a);i.show(),setTimeout(()=>{i.hide()},2e3)}})}),$(e).on("click","button[name^=btn]",function(){$(this).toggleClass("active");let e=window.lastArr;e&&e.length>0&&n(e)}),$(e).on("change","#addr3",()=>{let e=$("#addr1").val()+"-"+$("#addr2").val()+"-"+$("#addr3").val();callAjax(`${o}/json/${encodeURI(e)}.json`,e=>{window.lastArr=e,n(e)})});let n=e=>{geolocationFunc((o,n)=>{let a=[];if(o&&n){for(let i of e)if(o&&n&&i.lat&&i.lng){let l=getDistanceFromLatLng(Number(i.lat),Number(i.lng),o,n);i.distanceKm=Number(l.toFixed(2))}e&&e.length>0&&e[0]&&e[0].distanceKm&&(e=e.sort((e,t)=>numberCompare(e.distanceKm,t.distanceKm)))}let r=$("button[name^=btn].active"),s=[];if(r.length>0)for(let c of r){let d=c.dataset.target.split("|");for(let p of d)s.push(p)}for(let u of e){let h=u.course,m=0;if(h&&s.length>0){for(let g of s)h.indexOf(g)>-1&&m++;if(0===m)continue}if(keyExists(u,"distanceKm")){let f=[];f.push('<div class="d-flex w-100 justify-content-between">'),f.push('<h5 class="mb-1">'+u.name+"</h5>"),f.push('<small class="text-muted">'+u.distanceKm+"km</small>"),f.push("</div>");let v=checkAvailableWorkingTime(t,u.workingTime),_="";v||(_=" list-group-item-secondary"),a.push(`<a href="javascript:;" onclick="detail('${u.url}');" class="list-group-item list-group-item-action${_}">${f.join("")}</a>`)}else a.push('<a href="javascript:;" onclick="detail(\''+u.url+'\');" class="list-group-item list-group-item-action">'+u.name+"</a>")}$("#list").html(a.join(""))})}};$(document).ready(()=>{callAjax("/json/holiday.json",e=>{let t=getKst().toISOString().substring(0,10);keyExists(e,t)?init(window.document,!0):init(window.document,!1)})});
